<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='UTF-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>Candle in the Dark Church</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&family=Segoe+UI:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <div class="menu_left-section">
      <img src='https://raw.githubusercontent.com/cidc1/Candle-in-the-Dark-Church/main/logo.png' alt='Logo' class='logo'>
      <h1>Candle in the Dark Church</h1>
    </div>
    <nav class="menu">
      <ul>
        <li><a href="index.html" class="active">Home</a></li>
        <li><a href="https://www.daghewardmills.org/" target="_blank">DHMM</a></li>
        <li><a href="branches.html">Branches</a></li>
        <li><a href="https://udnews.org/" target="_blank">News</a></li>
        <li><a href="books.html">Books</a></li>
        <li><a href="media-links.html">DHMM Media</a></li>
        <li><a href="music.html">Music</a></li>
        <li><a href="audio.html">Audio</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </nav>
  </header>

  <div class='church-banner'>
    <div class="container"> <h2>About Us</h2>
      <p>
        Candle in the Dark Church, a vibrant ministry under the Dag Heward-Mills Ministry (DHMM), is passionately dedicated to spreading the Gospel. Led by Bishop Immanuel Obeng from our headquarters in Milan, Italy, we focus on evangelism, church planting, and discipleship across nations like France, Spain, Austria, Germany, Hungary, Poland, and Romania. Empowered by the Holy Spirit, we are committed to raising leaders and sending missionaries, following the vision of Evangelist Dag Heward-Mills to transform communities worldwide.
        <br><br>
        <span>'Go ye into all the world, and preach the gospel to every creature.' – Mark 16:15</span>
      </p>
    </div>

    <div class="bishopimg-container1"> <img src="" alt="Loading Slideshow..." class="bishopimg1" id="bishopSlideshowImage"> <button type="button" class="slide-nav-button prev" id="prevSlide" aria-label="Previous Slide" style="display: none;"> <i class="fas fa-chevron-left"></i>
      </button>
      <button type="button" class="slide-nav-button next" id="nextSlide" aria-label="Next Slide" style="display: none;"> <i class="fas fa-chevron-right"></i>
      </button>

      <div class="slide-indicators" id="slideIndicators">
        </div>
    </div>
  </div>

  <div class='theme-banner'>
    </div>

  <footer>
      <div class="row primary">
        <div class="column about">
         <h3>About Us</h3>
         <p>
             Candle in the Dark Church, under DHMM, is led by Bishop Immanuel Obeng, spreading the Gospel globally.
         </p>
        </div>
        <div class="column">
         <h3>Quick Links</h3>
         <ul class="footer-links">
             <li><a href="https://www.daghewardmills.org/" target="_blank">DHMM</a></li>
             <li><a href="branches.html">Branches</a></li>
             <li><a href="https://udnews.org/" target="_blank">News</a></li>
             <li><a href="books.html">Books</a></li>
             <li><a href="media-links.html">DHMM Media</a></li>
             <li><a href="music.html">Music</a></li>
             <li><a href="audio.html">Audio</a></li>
             <li><a href="contact.html">Contact Us</a></li>
           </ul>
        </div>
        <div class="column map-column">
         <h3>Our Location</h3>
         <div class="map-responsive">
               <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2796.337470107919!2d9.27891521555678!3d45.52891297910146!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x4786c799a6b1c6d7%3A0xf1d1a08f35a1841a!2sVia%20Wolfgang%20Amadeus%20Mozart%2C%2039%2C%2020093%20Cologno%20Monzese%20MI%2C%20Italy!5e0!3m2!1sen!2sus!4v1678886150123!5m2!1sen!2sus" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
             </div>
        </div>
        <div class="column contact">
         <h3>Contact Us</h3>
           <p><i class="fas fa-map-marker-alt"></i> Via Wolfgang Amadeus Mozart, 39,<br> 20093 Milano MI, Italy</p>
           <p><i class="fas fa-envelope"></i> candleinthedarkchurch@gmail.com</p>
           <p><i class="fas fa-phone"></i> +39 389 159 0184</p>
           <h3>Connect</h3>
           <div class="social">
            <a href="https://www.facebook.com/candleinthedarkhq" target="_blank" title="Facebook"><i class="fab fa-facebook-square"></i></a>
            <a href="https://www.instagram.com/cidc.hq/?igsh=czhpaGxpNmQ0bGli" target="_blank" title="Instagram"><i class="fab fa-instagram-square"></i></a>
            <a href="https://x.com/i/flow/login?redirect_after_login=%2FCIDCHQ" target="_blank" title="Twitter/X"><i class="fab fa-twitter-square"></i></a>
           </div>
        </div>
      </div>
    <div class="row copyright">
      <p>© <script>document.write(new Date().getFullYear())</script> Candle in the Dark Church. All rights reserved.</p>
    </div>
  </footer>

<script>
    // --- Elements ---
    const bishopImageElement = document.getElementById('bishopSlideshowImage');
    const prevButton = document.getElementById('prevSlide');
    const nextButton = document.getElementById('nextSlide');
    const indicatorsContainer = document.getElementById('slideIndicators');

    // --- Image Data (Will be loaded from JSON) ---
    let bishopImages = []; // Start empty
    // NOTE: Alt texts are harder to manage automatically this way.
    // You might create default ones or fetch another JSON file for them.
    // For simplicity here, we'll generate basic alt text.
    let bishopAltTexts = [];

    // --- State Variables ---
    let currentImageIndex = 0;
    let slideInterval;
    const FADE_DURATION = 500;
    const SLIDE_INTERVAL_DELAY = 5000;

    // --- Functions ---
    function generateAltText(filename) {
        // Basic alt text generation - improve as needed
        let namePart = filename.split('.')[0]; // Get name before extension
        namePart = namePart.replace(/_/g, ' ').replace(/-/g, ' '); // Replace underscores/hyphens
        // Capitalize first letter of each word (simple version)
        namePart = namePart.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
        return `Candle in the Dark Church - ${namePart}`;
    }

    function updateSlide(index) {
        if (!bishopImageElement || bishopImages.length === 0) return;
        currentImageIndex = (index + bishopImages.length) % bishopImages.length;
        bishopImageElement.style.opacity = 0;
        setTimeout(() => {
            if (bishopImageElement && bishopImages.length > currentImageIndex && bishopAltTexts.length > currentImageIndex) {
                // Prepend the 'images/' path here
                bishopImageElement.src = 'images/' + bishopImages[currentImageIndex];
                bishopImageElement.alt = bishopAltTexts[currentImageIndex];
                bishopImageElement.style.opacity = 1;
            } else {
                 console.error(`Error updating slide: Index ${currentImageIndex} out of bounds or element missing.`);
            }
            updateDots();
        }, FADE_DURATION / 2);
    }

    function updateDots() {
        if (!indicatorsContainer) return;
        const dots = indicatorsContainer.children;
        for (let i = 0; i < dots.length; i++) {
            if(dots[i]) {
                dots[i].classList.toggle('active', i === currentImageIndex);
            }
        }
    }

    function nextSlide() { updateSlide(currentImageIndex + 1); }
    function prevSlide() { updateSlide(currentImageIndex - 1); }

    function startSlideShow() {
        clearInterval(slideInterval);
        if (bishopImages.length > 1) {
            slideInterval = setInterval(nextSlide, SLIDE_INTERVAL_DELAY);
        }
    }

    // --- Initialization ---
    async function initSlideshow() { // Make async to use await for fetch
        if (!bishopImageElement || !prevButton || !nextButton || !indicatorsContainer) {
             console.error("Slideshow init failed: Core HTML elements missing.");
             return;
        }

        try {
            // == FETCH THE IMAGE LIST ==
            // Adjust path if imageList.json is not in the root directory
            const response = await fetch('imageList.json'); // Or e.g., 'images/imageList.json'
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            const imageFilenames = await response.json();

            if (!Array.isArray(imageFilenames) || imageFilenames.length === 0) {
                 throw new Error("imageList.json is empty or not a valid array.");
            }

            bishopImages = imageFilenames; // Assign fetched filenames
            // Generate basic alt texts (or load another JSON)
            bishopAltTexts = bishopImages.map(filename => generateAltText(filename));

            // === Now proceed with the rest of the initialization ===

            bishopImageElement.onerror = function() {
                console.error(`!!! IMAGE LOAD ERROR !!!\nFailed path: ${this.src}\nCheck: File exists in 'images/'? Exact filename (CASE + extension)?`);
                // Optionally: show placeholder, hide broken image icon
                this.alt = `Error Loading Image`; // Update alt on error
            };

            if (bishopImages.length > 1) {
                 // Show controls now that we have images
                 prevButton.style.display = 'flex';
                 nextButton.style.display = 'flex';

                indicatorsContainer.innerHTML = ''; // Clear dots
                bishopImages.forEach((_, index) => {
                    const dot = document.createElement('span');
                    dot.classList.add('slide-dot');
                    dot.setAttribute('role', 'button');
                    dot.setAttribute('aria-label', `Go to slide ${index + 1}`);
                    dot.addEventListener('click', () => {
                        if (index !== currentImageIndex) {
                             updateSlide(index);
                             startSlideShow();
                        }
                    });
                    indicatorsContainer.appendChild(dot);
                });

                prevButton.addEventListener('click', () => { prevSlide(); startSlideShow(); });
                nextButton.addEventListener('click', () => { nextSlide(); startSlideShow(); });

                startSlideShow();
            } else {
                // Only one image, hide controls (already hidden by default)
                indicatorsContainer.style.display = 'none'; // Ensure dots are hidden
            }

            // Set initial state ONLY after loading JSON
            if(bishopImages.length > 0) {
                updateSlide(0); // Load the first image
            } else {
                 bishopImageElement.alt = "No images found for slideshow."; // Show message if list is empty
            }


        } catch (error) {
            console.error("Could not initialize slideshow:", error);
            // Hide controls and show an error message
            bishopImageElement.alt = "Error loading slideshow images.";
            prevButton.style.display = 'none';
            nextButton.style.display = 'none';
            indicatorsContainer.style.display = 'none';
        }
    }

    // --- Run Initialization ---
    document.addEventListener('DOMContentLoaded', initSlideshow);

</script>

</body>
</html>
